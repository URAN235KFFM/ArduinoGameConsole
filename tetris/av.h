
#ifndef av_h
#define av_h

#include <inttypes.h>

#define HERTZ(n) ((uint16_t)((n)*65536.0/15625.0))

typedef struct _AV_VOICE
{
  uint8_t volume;
  uint8_t currentvolume;
  uint8_t* waveform;  // point to program space
  uint8_t duty;  // for rectangle only
  uint16_t frequency;
  uint16_t phase;
} _AV_VOICE;


void av_init(uint8_t *tileset, uint8_t *defaultwaveform);
void av_waitForBlanking();
void av_setTileSet(uint8_t *tilesset);

extern uint8_t videoMatrix[320];
extern _AV_VOICE voiceA;
extern _AV_VOICE voiceB;
extern _AV_VOICE voiceC;
extern _AV_VOICE voiceD;



#define XXXX 0
#define XXXO 1
#define XXXl 16
#define XXX_ 17
#define XXOX 2
#define XXOO 3
#define XXOl 18
#define XXO_ 19
#define XXlX 32
#define XXlO 33
#define XXll 48
#define XXl_ 49
#define XX_X 34
#define XX_O 35
#define XX_l 50
#define XX__ 51
#define XOXX 4
#define XOXO 5
#define XOXl 20
#define XOX_ 21
#define XOOX 6
#define XOOO 7
#define XOOl 22
#define XOO_ 23
#define XOlX 36
#define XOlO 37
#define XOll 52
#define XOl_ 53
#define XO_X 38
#define XO_O 39
#define XO_l 54
#define XO__ 55
#define XlXX 64
#define XlXO 65
#define XlXl 80
#define XlX_ 81
#define XlOX 66
#define XlOO 67
#define XlOl 82
#define XlO_ 83
#define XllX 96
#define XllO 97
#define Xlll 112
#define Xll_ 113
#define Xl_X 98
#define Xl_O 99
#define Xl_l 114
#define Xl__ 115
#define X_XX 68
#define X_XO 69
#define X_Xl 84
#define X_X_ 85
#define X_OX 70
#define X_OO 71
#define X_Ol 86
#define X_O_ 87
#define X_lX 100
#define X_lO 101
#define X_ll 116
#define X_l_ 117
#define X__X 102
#define X__O 103
#define X__l 118
#define X___ 119
#define OXXX 8
#define OXXO 9
#define OXXl 24
#define OXX_ 25
#define OXOX 10
#define OXOO 11
#define OXOl 26
#define OXO_ 27
#define OXlX 40
#define OXlO 41
#define OXll 56
#define OXl_ 57
#define OX_X 42
#define OX_O 43
#define OX_l 58
#define OX__ 59
#define OOXX 12
#define OOXO 13
#define OOXl 28
#define OOX_ 29
#define OOOX 14
#define OOOO 15
#define OOOl 30
#define OOO_ 31
#define OOlX 44
#define OOlO 45
#define OOll 60
#define OOl_ 61
#define OO_X 46
#define OO_O 47
#define OO_l 62
#define OO__ 63
#define OlXX 72
#define OlXO 73
#define OlXl 88
#define OlX_ 89
#define OlOX 74
#define OlOO 75
#define OlOl 90
#define OlO_ 91
#define OllX 104
#define OllO 105
#define Olll 120
#define Oll_ 121
#define Ol_X 106
#define Ol_O 107
#define Ol_l 122
#define Ol__ 123
#define O_XX 76
#define O_XO 77
#define O_Xl 92
#define O_X_ 93
#define O_OX 78
#define O_OO 79
#define O_Ol 94
#define O_O_ 95
#define O_lX 108
#define O_lO 109
#define O_ll 124
#define O_l_ 125
#define O__X 110
#define O__O 111
#define O__l 126
#define O___ 127
#define lXXX 128
#define lXXO 129
#define lXXl 144
#define lXX_ 145
#define lXOX 130
#define lXOO 131
#define lXOl 146
#define lXO_ 147
#define lXlX 160
#define lXlO 161
#define lXll 176
#define lXl_ 177
#define lX_X 162
#define lX_O 163
#define lX_l 178
#define lX__ 179
#define lOXX 132
#define lOXO 133
#define lOXl 148
#define lOX_ 149
#define lOOX 134
#define lOOO 135
#define lOOl 150
#define lOO_ 151
#define lOlX 164
#define lOlO 165
#define lOll 180
#define lOl_ 181
#define lO_X 166
#define lO_O 167
#define lO_l 182
#define lO__ 183
#define llXX 192
#define llXO 193
#define llXl 208
#define llX_ 209
#define llOX 194
#define llOO 195
#define llOl 210
#define llO_ 211
#define lllX 224
#define lllO 225
#define llll 240
#define lll_ 241
#define ll_X 226
#define ll_O 227
#define ll_l 242
#define ll__ 243
#define l_XX 196
#define l_XO 197
#define l_Xl 212
#define l_X_ 213
#define l_OX 198
#define l_OO 199
#define l_Ol 214
#define l_O_ 215
#define l_lX 228
#define l_lO 229
#define l_ll 244
#define l_l_ 245
#define l__X 230
#define l__O 231
#define l__l 246
#define l___ 247
#define _XXX 136
#define _XXO 137
#define _XXl 152
#define _XX_ 153
#define _XOX 138
#define _XOO 139
#define _XOl 154
#define _XO_ 155
#define _XlX 168
#define _XlO 169
#define _Xll 184
#define _Xl_ 185
#define _X_X 170
#define _X_O 171
#define _X_l 186
#define _X__ 187
#define _OXX 140
#define _OXO 141
#define _OXl 156
#define _OX_ 157
#define _OOX 142
#define _OOO 143
#define _OOl 158
#define _OO_ 159
#define _OlX 172
#define _OlO 173
#define _Oll 188
#define _Ol_ 189
#define _O_X 174
#define _O_O 175
#define _O_l 190
#define _O__ 191
#define _lXX 200
#define _lXO 201
#define _lXl 216
#define _lX_ 217
#define _lOX 202
#define _lOO 203
#define _lOl 218
#define _lO_ 219
#define _llX 232
#define _llO 233
#define _lll 248
#define _ll_ 249
#define _l_X 234
#define _l_O 235
#define _l_l 250
#define _l__ 251
#define __XX 204
#define __XO 205
#define __Xl 220
#define __X_ 221
#define __OX 206
#define __OO 207
#define __Ol 222
#define __O_ 223
#define __lX 236
#define __lO 237
#define __ll 252
#define __l_ 253
#define ___X 238
#define ___O 239
#define ___l 254
#define ____ 255

#endif
